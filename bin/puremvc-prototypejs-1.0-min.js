var Facade=Class.create({view:null,model:null,controller:null,initialize:function(){if(Facade.instance){throw Error(Facade.SINGLETON_MSG)}this.initializeFacade()},initializeFacade:function(){this.initializeModel();this.initializeController();this.initializeView()},initializeModel:function(){if(!this.model){this.model=Model.getInstance()}},initializeController:function(){if(!this.controller){this.controller=Controller.getInstance()}},initializeView:function(){if(!this.view){this.view=View.getInstance()
}},registerCommand:function(a,b){this.controller.registerCommand(a,b)},removeCommand:function(a){this.controller.removeCommand(a)},hasCommand:function(a){return this.controller.hasCommand(a)},registerProxy:function(a){this.model.registerProxy(a)},retrieveProxy:function(a){return this.model.retrieveProxy(a)},removeProxy:function(a){return this.model.removeProxy(a)},hasProxy:function(a){return this.model.hasProxy(a)},registerMediator:function(a){this.view.registerMediator(a)},retrieveMediator:function(a){return this.view.retrieveMediator(a)
},removeMediator:function(a){return this.view.removeMediator(a)},hasMediator:function(a){return this.view.hasMediator(a)},sendNotification:function(b,a,c){this.notifyObservers(new Notification(b,a,c))},notifyObservers:function(a){this.view.notifyObservers(a)}});Facade.SINGLETON_MSG="Facade Singleton already constructed!";Facade.instance=null;Facade.getInstance=function(){if(!Facade.instance){Facade.instance=new Facade()}return Facade.instance};var Notification=Class.create({name:null,body:null,type:null,initialize:function(b,a,c){this.name=b;
this.body=a;this.type=c},getName:function(){return this.name},setBody:function(a){this.body=a},getBody:function(){return this.body},setType:function(a){this.type=a},getType:function(){return this.type},toString:function(){var a="Notification Name: "+this.getName();a+="\nBody:"+((this.getBody()==null)?"null":this.getBody().toString());a+="\nType:"+((this.getType()==null)?"null":this.getType());return a}});var Notifier=Class.create({facade:null,initialize:function(){this.facade=Facade.getInstance()
},sendNotification:function(b,a,c){this.facade.sendNotification(b,a,c)}});var Observer=Class.create({notify:null,context:null,initialize:function(a,b){this.setNotifyMethod(a);this.setNotifyContext(b)},getNotifyMethod:function(){return this.notify},setNotifyMethod:function(a){this.notify=a},getNotifyContext:function(){return this.context},setNotifyContext:function(a){this.context=a},notifyObserver:function(a){this.getNotifyMethod().call(this.getNotifyContext(),a)},compareNotifyContext:function(a){return a===this.getNotifyContext()
}});var Controller=Class.create({view:null,commandMap:null,initialize:function(){if(Controller.instance){throw Error(Controller.SINGLETON_MSG)}this.commandMap={};this.initializeController()},initializeController:function(){this.view=View.getInstance()},executeCommand:function(a){var c=this.commandMap[a.getName()];if(c){var b=new c();b.execute(a)}},registerCommand:function(a,b){if(!this.commandMap[a]){this.view.registerObserver(a,new Observer(this.executeCommand,this))}this.commandMap[a]=b},hasCommand:function(a){return this.commandMap[a]?true:false
},removeCommand:function(a){if(this.hasCommand(a)){this.view.removeObserver(a,this);delete this.commandMap[a]}}});Controller.SINGLETON_MSG="Controller Singleton already constructed!";Controller.instance=null;Controller.getInstance=function(){if(!Controller.instance){Controller.instance=new Controller()}return Controller.instance};var Model=Class.create({proxyMap:null,initialize:function(){if(Model.instance){throw Error(Model.SINGLETON_MSG)}this.proxyMap={};this.initializeModel()},registerProxy:function(a){this.proxyMap[a.getProxyName()]=a;
a.onRegister()},retrieveProxy:function(b){var a=this.proxyMap[b];return a?a:null},hasProxy:function(a){return this.proxyMap[a]?true:false},removeProxy:function(b){var a=this.proxyMap[b];if(!a){return null}delete this.proxyMap[b];a.onRemove();return a},initializeModel:function(){}});Model.SINGLETON_MSG="Model Singleton already constructed!";Model.instance=new Model();Model.getInstance=function(){if(!Model.instance){Model.instance=new Model()}return Model.instance};var View=Class.create({mediatorMap:null,observerMap:null,initialize:function(){if(View.instance){throw Error(View.SINGLETON_MSG)
}this.mediatorMap={};this.observerMap={};this.initializeView()},initializeView:function(){},registerObserver:function(b,a){var c=this.observerMap[b];if(c){c.push(a)}else{this.observerMap[b]=[a]}},notifyObservers:function(e){var c=e.getName();var g=this.observerMap[c];if(g){var f=g.slice(0);var a=f.length;for(var d=0;d<a;d++){var b=f[d];b.notifyObserver(e)}}},removeObserver:function(b,d){var e=this.observerMap[b];var c=e.length;while(c--){var a=e[c];if(a.compareNotifyContext(d)){e.splice(c,1);break
}}if(!e.length){delete this.observerMap[b]}},registerMediator:function(e){var c=e.getMediatorName();if(this.mediatorMap[c]){return}this.mediatorMap[c]=e;var f=e.listNotificationInterests();var a=f.length;if(a){var b=new Observer(e.handleNotification,e);for(var d=0;d<a;d++){this.registerObserver(f[d],b)}}e.onRegister()},retrieveMediator:function(a){var b=this.mediatorMap[a];return b?b:null},hasMediator:function(a){return this.mediatorMap[a]?true:false},removeMediator:function(a){var c=this.mediatorMap[a];
if(!c){return null}var d=c.listNotificationInterests();var b=d.length;while(b--){this.removeObserver(d[b],c)}delete this.mediatorMap[a];c.onRemove();return c}});View.SINGLETON_MSG="View Singleton already constructed!";View.instance=null;View.getInstance=function(){if(View.instance==null){View.instance=new View()}return View.instance};var MacroCommand=Class.create(Notifier,{subCommands:null,initialize:function($super){$super();this.subCommands=[];this.initializeMacroCommand()},initializeMacroCommand:function(){},addSubCommand:function(a){this.subCommands.push(a)
},execute:function(a){while(this.subCommands.length>0){var c=this.subCommands.shift();var b=new c();b.execute(a)}}});var SimpleCommand=Class.create(Notifier,{execute:function(a){}});var Mediator=Class.create(Notifier,{mediatorName:null,viewComponent:null,initialize:function($super,a,b){$super();this.mediatorName=(a!=null)?a:Mediator.NAME;this.viewComponent=b},listNotificationInterests:function(){return[]},getMediatorName:function(){return this.mediatorName},getViewComponent:function(){return this.viewComponent
},setViewComponent:function(a){this.viewComponent=a},handleNotification:function(a){},onRegister:function(){},onRemove:function(){}});Mediator.NAME="Mediator";var Proxy=Class.create(Notifier,{data:null,proxyName:null,initialize:function($super,b,a){$super();this.proxyName=(b!=null)?b:Proxy.NAME;this.data=a},getProxyName:function(){return this.proxyName},setData:function(a){this.data=a},getData:function(){return this.data},onRegister:function(){},onRemove:function(){}});Proxy.NAME="Proxy";